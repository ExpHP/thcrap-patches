codecaves:
  protection: "0x40"
  ExpHP.anm-buffers.game-data:
    /value-if(th16):
      - "FC050000          " # at GameData.vm_size, dd 0x5fc
      - "AC494700          " # at GameData.func_malloc, dd 0x4749ac

binhacks:

  ExpHP.anm-buffers.alloc:
    addr:
      /value-if(th16): "0x46f6ef"
    expected:
      /value-if(th16): "68fc050000"
    codecave:
      - "E8[codecave:ExpHP.anm-buffers.new-alloc-vm]" # call new_alloc_vm
      - /item-if(th16): "E800000000C70424FCF64600C3" # abs_jmp_hack 0x46f6fc

  ExpHP.anm-buffers.dealloc:
    addr:
      /value-if(th16): "0x46ec48"
    expected:
      /value-if(th16): "50e864930000"
    codecave:
      - "E8[codecave:ExpHP.anm-buffers.new-dealloc-vm]" # call new_dealloc_vm
      - /item-if(th16): "E800000000C7042451EC4600C3" # abs_jmp_hack 0x46ec51
