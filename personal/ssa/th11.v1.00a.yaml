
binhacks:
  ExpHP.ddc-gap.no-demoplay:
    addr: "0x4399c8"
    expected: "01355c574a00"
    code:     "909090909090"

  ExpHP.ddc-gap.start-server:
    addr: "0x408558"
    expected: "8B3D688D4A00"
    codecave:
      - "E8[codecave:ExpHP.ddc-gap.server-start-stage]" # call server_start_stage 
      # original code
      - "8B3D688D4A00      " # mov     edi, dword [0x4a8d68]
      # abs_jmp_hack 0x40855e
      - "E800000000        " # call %%next
      - "C704245E854000    " # mov dword [esp], %1
      - "C3                " # ret

  ExpHP.ddc-gap.send-input:
    addr: "0x457a0b"
    expected: "e840210000"
    # This is placed right after the game writes HARDWARE_INPUT and HARDWARE_INPUT_PREV,
    # but before it calls the function that works out rising/falling edges and key repeats.
    codecave:
      - "E8[codecave:ExpHP.ddc-gap.server-send-input]" # call server_send_input
      # original code
      - "B9A8924C00        " # mov  ecx, 0x4c92a8
      - "B8509B4500        " # mov  eax, 0x459b50
      - "FFD0              " # call eax
      # abs_jmp_hack 0x457a10
      - "E800000000        " # call %%next
      - "C70424107A4500    " # mov dword [esp], %1
      - "C3                " # ret

  ExpHP.cave-recv-player-pos:
    addr: "0x430853"
    expected: "db8588080000"
    codecave:
      - "8D8588080000      " # lea  eax, [ebp+0x888]
      - "50                " # push eax
      - "E8[codecave:ExpHP.ddc-gap.recv-player-pos]" # call recv_player_pos

      - "81858808000000CC0000" # add  dword [ebp+0x888], ORIGIN_TO_ORIGIN_SUBPIXELS

      - "DB8588080000      " # fild dword [ebp+0x888]
      # abs_jmp_hack 0x430859
      - "E800000000        " # call %%next
      - "C7042459084300    " # mov dword [esp], %1
      - "C3                " # ret

codecaves:
  ExpHP.ddc-gap.corefuncs:
    # These are pointers to IAT entries, but during initialization we'll replace
    # them with pointers to the actual functions.
    - "B8B14800          " # .GetLastError: dd 0x48b1b8
    - "74B14800          " # .GetModuleHandleW: dd 0x48b174
    - "70B14800          " # .GetProcAddress: dd 0x48b170
    - "F0B04800          " # .WaitForSingleObject: dd 0x48b0f0
  
  ExpHP.ddc-gap.gamedata:
    - "A8924C00          " # .HARDWARE_INPUT: dd 0x4c92a8
